meta {
  name: Create Splits
  type: http
  seq: 2
}

post {
  url: {{baseUrl}}/splits/transaction/{{transaction_id}}/batch
  body: json
  auth: inherit
}

params:query {
  ~limit: 10
  ~offset: 0
  ~start_date: 2025-05-01
  ~end_date: 2025-04-01
}

body:json {
  {
      "splits": [
          {   
              "split_percent": "1",
              "split_amount": "10",
              "split_user": 2
          }
      ]
  }
}

settings {
  encodeUrl: true
  timeout: 0
}

example {
  name: Update Splits
  
  request: {
    url: {{baseUrl}}/splits/transaction/{{transaction_id}}/batch
    method: PUT
    mode: json
    params:query: {
      ~limit: 10
      ~offset: 0
      ~start_date: 2025-05-01
      ~end_date: 2025-04-01
    }
  
    body:json: {
      {
          "splits": [
              {
                  "split_percent": "0.5",
                  "split_amount": "250",
                  "split_user": 1
              },
              {
                  "split_percent": "0.5",
                  "split_amount": "250",
                  "split_user": 2
              }
          ]
      }
    }
  }
  
  response: {
    headers: {
      Content-Type: application/json
      Date: Mon, 20 Oct 2025 03:46:37 GMT
      Content-Length: 905
    }
  
    status: {
      code: OK
      text: 200
    }
  
    body: {
      type: json
      content: '''
        {
            "deleted_splits": [
                {
                    "id": 32,
                    "transaction_id": 1,
                    "tx_amount": "500",
                    "split_percent": "0.6",
                    "split_amount": "300",
                    "split_user": 1,
                    "created_at": "2025-10-18T15:07:49.360572-06:00",
                    "modified_at": "2025-10-18T15:07:49.360572-06:00"
                },
                {
                    "id": 33,
                    "transaction_id": 1,
                    "tx_amount": "500",
                    "split_percent": "0.4",
                    "split_amount": "200",
                    "split_user": 2,
                    "created_at": "2025-10-18T15:07:49.360572-06:00",
                    "modified_at": "2025-10-18T15:07:49.360572-06:00"
                }
            ],
            "new_splits": [
                {
                    "id": 34,
                    "transaction_id": 1,
                    "tx_amount": "500",
                    "split_percent": "0.5",
                    "split_amount": "250",
                    "split_user": 1,
                    "created_at": "2025-10-19T21:46:37.509711-06:00",
                    "modified_at": "2025-10-19T21:46:37.509711-06:00"
                },
                {
                    "id": 35,
                    "transaction_id": 1,
                    "tx_amount": "500",
                    "split_percent": "0.5",
                    "split_amount": "250",
                    "split_user": 2,
                    "created_at": "2025-10-19T21:46:37.509711-06:00",
                    "modified_at": "2025-10-19T21:46:37.509711-06:00"
                }
            ],
            "message": "Successfully replaced 2 splits with 2 new splits"
        }
      '''
    }
  }
}
